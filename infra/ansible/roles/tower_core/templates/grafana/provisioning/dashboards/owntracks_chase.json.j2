{
  "annotations": { "list": [] },
  "editable": true,
  "gnetId": null,
  "graphTooltip": 0,
  "id": null,
  "links": [],
  "panels": [
    {
      "id": 1,
      "gridPos": { "h": 18, "w": 18, "x": 0, "y": 0 },
      "title": "TACTICAL: Live Tracking (Chase Mode)",
      "type": "geomap",
      "datasource": "InfluxDB-Core",
      "targets": [
        {
          "refId": "A",
          "queryType": "flux",
          "query": "from(bucket: \"telegraf\")\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\n  |> filter(fn: (r) => r[\"_measurement\"] == \"owntracks\")\n  |> filter(fn: (r) => r[\"tid\"] == \"${tid}\")\n  |> filter(fn: (r) => r[\"_field\"] == \"lat\" or r[\"_field\"] == \"lon\" or r[\"_field\"] == \"batt\")\n  |> pivot(rowKey:[\"_time\"], columnKey: [\"_field\"], valueColumn: \"_value\")\n  |> group(columns: [\"tid\"])\n  |> sort(columns: [\"_time\"], desc: false)"
        }
      ],
      "options": {
        "view": { "id": "fit", "lat": 0, "lon": 0, "zoom": 18 },
        "layers": [
          {
            "type": "markers",
            "name": "Target",
            "config": {
              "style": { "size": { "fixed": 15 }, "color": { "fixed": "#00FF00" }, "symbol": { "fixed": "circle" } },
              "showLegend": true
            },
            "location": { "mode": "coords", "latitude": "lat", "longitude": "lon" },
            "tooltip": { "mode": "details", "primary": "tid" }
          },
          {
            "type": "route",
            "name": "Trajectory (2m)",
            "config": {
              "style": { "color": { "fixed": "#A333C8" }, "width": 5, "opacity": 0.8 }
            },
            "location": { "mode": "coords", "latitude": "lat", "longitude": "lon" }
          }
        ]
      }
    },
    {
      "id": 2,
      "gridPos": { "h": 6, "w": 6, "x": 18, "y": 0 },
      "title": "Battery",
      "type": "gauge",
      "datasource": "InfluxDB-Core",
      "targets": [
        {
          "refId": "A",
          "queryType": "flux",
          "query": "from(bucket: \"telegraf\")\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\n  |> filter(fn: (r) => r[\"_measurement\"] == \"owntracks\")\n  |> filter(fn: (r) => r[\"tid\"] == \"${tid}\")\n  |> filter(fn: (r) => r[\"_field\"] == \"batt\")\n  |> group(columns: [\"tid\"])\n  |> last()"
        }
      ],
      "fieldConfig": { "defaults": { "min": 0, "max": 100, "unit": "percent", "thresholds": { "mode": "absolute", "steps": [ { "color": "red", "value": null }, { "color": "#EAB839", "value": 20 }, { "color": "green", "value": 50 } ] } } }
    },
    {
      "id": 3,
      "gridPos": { "h": 4, "w": 6, "x": 18, "y": 6 },
      "title": "Velocity",
      "type": "stat",
      "datasource": "InfluxDB-Core",
      "targets": [
        {
          "refId": "A",
          "queryType": "flux",
          "query": "from(bucket: \"telegraf\")\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\n  |> filter(fn: (r) => r[\"_measurement\"] == \"owntracks\")\n  |> filter(fn: (r) => r[\"tid\"] == \"${tid}\")\n  |> filter(fn: (r) => r[\"_field\"] == \"vel\")\n  |> group(columns: [\"tid\"])\n  |> last()"
        }
      ],
      "fieldConfig": { "defaults": { "unit": "velocitykmh", "thresholds": { "mode": "absolute", "steps": [{ "color": "blue", "value": null }, { "color": "orange", "value": 80 }, { "color": "red", "value": 120 }] } } },
      "options": { "graphMode": "area", "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false } }
    },
    {
      "id": 4,
      "gridPos": { "h": 4, "w": 6, "x": 18, "y": 10 },
      "title": "Altitude",
      "type": "stat",
      "datasource": "InfluxDB-Core",
      "targets": [
        {
          "refId": "A",
          "queryType": "flux",
          "query": "from(bucket: \"telegraf\")\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\n  |> filter(fn: (r) => r[\"_measurement\"] == \"owntracks\")\n  |> filter(fn: (r) => r[\"tid\"] == \"${tid}\")\n  |> filter(fn: (r) => r[\"_field\"] == \"alt\")\n  |> group(columns: [\"tid\"])\n  |> last()"
        }
      ],
      "fieldConfig": { "defaults": { "unit": "lengthm" } },
      "options": { "graphMode": "none", "reduceOptions": { "calcs": ["lastNotNull"] } }
    },
    {
      "id": 5,
      "gridPos": { "h": 4, "w": 6, "x": 18, "y": 14 },
      "title": "GPS Accuracy",
      "type": "stat",
      "datasource": "InfluxDB-Core",
      "targets": [
        {
          "refId": "A",
          "queryType": "flux",
          "query": "from(bucket: \"telegraf\")\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\n  |> filter(fn: (r) => r[\"_measurement\"] == \"owntracks\")\n  |> filter(fn: (r) => r[\"tid\"] == \"${tid}\")\n  |> filter(fn: (r) => r[\"_field\"] == \"acc\")\n  |> group(columns: [\"tid\"])\n  |> last()"
        }
      ],
      "fieldConfig": { "defaults": { "unit": "lengthm", "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "red", "value": 10 }] } } },
      "options": { "graphMode": "none", "reduceOptions": { "calcs": ["lastNotNull"] } }
    }
  ],
  "refresh": "5s",
  "schemaVersion": 30,
  "style": "dark",
  "tags": ["Tracking", "GIS", "Live"],
  "templating": {
    "list": [
      {
        "current": { "selected": false, "text": "RW", "value": "RW" },
        "definition": "import \"influxdata/influxdb/schema\"\nschema.tagValues(bucket: \"telegraf\", tag: \"tid\")",
        "hide": 0,
        "includeAll": false,
        "label": "Tracker ID",
        "multi": false,
        "name": "tid",
        "options": [],
        "query": "import \"influxdata/influxdb/schema\"\nschema.tagValues(bucket: \"telegraf\", tag: \"tid\")",
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 1,
        "type": "query",
        "datasource": "InfluxDB-Core"
      }
    ]
  },
  "time": { "from": "now-2m", "to": "now" },
  "title": "OwnTracks (Chase Mode)",
  "uid": "owntracks-chase",
  "version": 1,
  "weekStart": ""
}
